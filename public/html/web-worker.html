<!DOCTYPE html>
<html lang="ja">

<head>
    <link rel="stylesheet" href="../css/index.css">
    <link rel="stylesheet" href="../css/commentMove.css">
</head>

<body>
    <div id="placeholder"></div>
    <!-- 要素の幅を取得するために利用するDOM -->
    <span id="ruler"></span>
    <!-- /socket.io/socket.io.js は自動で生成されるので作成する必要はない -->
    <script src="/socket.io/socket.io.js"></script>
    <script>
        const calcWindowSize = () => {
            return [
                Math.round(document.documentElement.clientHeight / windowDevided),
                document.documentElement.clientWidth,
            ]
        }

        // ブラウザに何行のコメントを表示するか
        const windowDevided = 11;
        document.documentElement.style.setProperty('--windowDevided', windowDevided);

        const container = document.getElementById('placeholder');
        for (let i = 0; i < windowDevided; i++) {
            const element = document.createElement('div');
            element.className = 'row';
            element.id = `row${i}`;
            container.appendChild(element);
        }

        // コメント1行の高さ,幅を取得(スクロールバーを除いたもの)
        let [commentHeight, commentMoveWidth] = calcWindowSize();
        // コメントの表示時間(単位：ms)
        const commentDisplayTime = 5000;

        // 流れたコメントの数(GSAPによるコメントの移動に用いる)
        let count = 0;

        // 各行の情報を持つ配列の作成
        const rows = Array(windowDevided)
            .fill()
            .map(e => ({
                bornTime: 0,
                speed: 0,
                width: 0,
            }));

        window.onresize = () => {
            [commentHeight, commentMoveWidth] = calcWindowSize();
        }
    </script>
    <script type="module" src="../js/worker.js"></script>
</body>

</html>